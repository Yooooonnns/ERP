<UserControl x:Class="DigitalisationERP.Desktop.Views.EmailPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             Background="{DynamicResource MaterialDesignPaper}">

    <Grid x:Name="RootGrid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="350"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Sidebar - Folders -->
        <Border Grid.Column="0" 
                Background="{DynamicResource MaterialDesignPaper}"
                BorderBrush="{DynamicResource MaterialDesignDivider}"
                BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Compose Button -->
                <Button Grid.Row="0"
                        x:Name="ComposeButton"
                        Margin="15,15,15,10"
                        Height="40"
                        Style="{StaticResource MaterialDesignRaisedButton}"
                        Click="ComposeButton_Click">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Plus" 
                                               Width="20" 
                                               Height="20"
                                               VerticalAlignment="Center"
                                               Margin="0,0,8,0"/>
                        <TextBlock Text="Compose" 
                                  FontSize="14"
                                  FontWeight="SemiBold"
                                  VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <!-- Folders List -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="5,0">
                        <Button x:Name="InboxButton"
                                Style="{StaticResource MaterialDesignFlatButton}"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Left"
                                Height="40"
                                Padding="15,0"
                                Click="FolderButton_Click"
                                Tag="Inbox">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <materialDesign:PackIcon Kind="Inbox" 
                                                       Width="20" 
                                                       Height="20"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="Inbox" 
                                          VerticalAlignment="Center"
                                          FontSize="14"/>
                                <TextBlock x:Name="InboxCount"
                                          Grid.Column="2"
                                          Text="12"
                                          FontSize="12"
                                          FontWeight="Bold"
                                          Foreground="{DynamicResource PrimaryHueMidBrush}"
                                          VerticalAlignment="Center"/>
                            </Grid>
                        </Button>

                        <Button Style="{StaticResource MaterialDesignFlatButton}"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Left"
                                Height="40"
                                Padding="15,0"
                                Click="FolderButton_Click"
                                Tag="Sent">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <materialDesign:PackIcon Kind="Send" 
                                                       Width="20" 
                                                       Height="20"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="Sent" 
                                          VerticalAlignment="Center"
                                          FontSize="14"/>
                            </Grid>
                        </Button>

                        <Button Style="{StaticResource MaterialDesignFlatButton}"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Left"
                                Height="40"
                                Padding="15,0"
                                Click="FolderButton_Click"
                                Tag="Reports">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <materialDesign:PackIcon Kind="FileDocumentOutline" 
                                                       Width="20" 
                                                       Height="20"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="Reports" 
                                          VerticalAlignment="Center"
                                          FontSize="14"/>
                            </Grid>
                        </Button>

                        <Button Style="{StaticResource MaterialDesignFlatButton}"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Left"
                                Height="40"
                                Padding="15,0"
                                Click="FolderButton_Click"
                                Tag="Drafts">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <materialDesign:PackIcon Kind="FileOutline" 
                                                       Width="20" 
                                                       Height="20"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="Drafts" 
                                          VerticalAlignment="Center"
                                          FontSize="14"/>
                            </Grid>
                        </Button>

                        <Button Style="{StaticResource MaterialDesignFlatButton}"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Left"
                                Height="40"
                                Padding="15,0"
                                Click="FolderButton_Click"
                                Tag="Trash">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <materialDesign:PackIcon Kind="Delete" 
                                                       Width="20" 
                                                       Height="20"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="Trash" 
                                          VerticalAlignment="Center"
                                          FontSize="14"/>
                            </Grid>
                        </Button>

                        <Separator Margin="10,10"/>

                        <!-- Workers Section -->
                        <TextBlock Text="WORKERS" 
                                  FontSize="11"
                                  FontWeight="Bold"
                                  Foreground="{DynamicResource MaterialDesignBodyLight}"
                                  Margin="15,10,15,5"/>

                        <ListBox x:Name="WorkersListBox"
                                BorderThickness="0"
                                SelectionChanged="WorkersListBox_SelectionChanged">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="5,2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Ellipse Width="28" Height="28" 
                                                Fill="{DynamicResource PrimaryHueLightBrush}"
                                                Margin="0,0,10,0"/>
                                        <TextBlock Grid.Column="0"
                                                  Text="{Binding Initials}"
                                                  FontSize="11"
                                                  FontWeight="Bold"
                                                  Foreground="White"
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding Name}" 
                                                      FontSize="13"/>
                                            <TextBlock Text="{Binding Role}" 
                                                      FontSize="10"
                                                      Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                                        </StackPanel>
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Middle - Email List -->
        <Border Grid.Column="1"
                Background="{DynamicResource MaterialDesignPaper}"
                BorderBrush="{DynamicResource MaterialDesignDivider}"
                BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Folder Title -->
                <TextBlock x:Name="FolderTitleText"
                          Grid.Row="0"
                          Text="Inbox"
                          FontSize="24"
                          FontWeight="Bold"
                          Margin="20,20,20,10"/>

                <!-- Search Bar -->
                <materialDesign:Card Grid.Row="1" 
                                    Margin="20,0,20,15"
                                    Padding="0">
                    <Grid>
                        <TextBox x:Name="SearchTextBox"
                                materialDesign:HintAssist.Hint="Search emails..."
                                BorderThickness="0"
                                Padding="40,10,10,10"
                                FontSize="14"/>
                        <materialDesign:PackIcon Kind="Magnify"
                                               Width="20"
                                               Height="20"
                                               Margin="12,0,0,0"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Left"
                                               Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                    </Grid>
                </materialDesign:Card>

                <!-- Email List -->
                <ListBox x:Name="EmailListBox"
                        Grid.Row="2"
                        BorderThickness="0"
                        SelectionChanged="EmailListBox_SelectionChanged">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="15,12" 
                                   BorderThickness="0,0,0,1"
                                   BorderBrush="{DynamicResource MaterialDesignDivider}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Avatar -->
                                    <Ellipse Grid.Column="0" 
                                            Grid.RowSpan="3"
                                            Width="40" 
                                            Height="40" 
                                            Fill="{DynamicResource PrimaryHueLightBrush}"
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Top"/>
                                    <TextBlock Grid.Column="0" 
                                              Grid.RowSpan="3"
                                              Text="{Binding SenderInitials}"
                                              FontSize="14"
                                              FontWeight="Bold"
                                              Foreground="White"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>

                                    <!-- Content -->
                                    <TextBlock Grid.Column="1" 
                                              Grid.Row="0"
                                              Text="{Binding Sender}" 
                                              FontWeight="SemiBold"
                                              FontSize="14"/>
                                    <TextBlock Grid.Column="1" 
                                              Grid.Row="1"
                                              Text="{Binding Subject}" 
                                              FontSize="13"
                                              Margin="0,2,0,0"/>
                                    <TextBlock Grid.Column="1" 
                                              Grid.Row="2"
                                              Text="{Binding Preview}" 
                                              FontSize="12"
                                              Foreground="{DynamicResource MaterialDesignBodyLight}"
                                              TextTrimming="CharacterEllipsis"
                                              Margin="0,4,0,0"/>

                                    <!-- Time and Attachment -->
                                    <StackPanel Grid.Column="2" 
                                               Grid.Row="0"
                                               Orientation="Horizontal"
                                               HorizontalAlignment="Right">
                                        <materialDesign:PackIcon Kind="Attachment"
                                                               Width="16"
                                                               Height="16"
                                                               Margin="0,0,8,0"
                                                               Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                                        <TextBlock Text="{Binding Time}" 
                                                  FontSize="12"
                                                  Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </Border>

        <!-- Right - Email Content/Compose -->
        <Grid Grid.Column="2" x:Name="ContentArea">
            <!-- This will dynamically show email content or compose view -->
            <TextBlock Text="Select an email to read"
                      FontSize="16"
                      Foreground="{DynamicResource MaterialDesignBodyLight}"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"/>
        </Grid>
    </Grid>
</UserControl>
