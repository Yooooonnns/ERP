<Window x:Class="DigitalisationERP.Desktop.Views.VerifyEmailWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Verify Email - Digitalisation ERP" 
        Height="450" 
        Width="500"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        FontFamily="{DynamicResource MaterialDesignFont}">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <materialDesign:ColorZone Grid.Row="0" 
                                  Mode="PrimaryMid" 
                                  Padding="16"
                                  materialDesign:ElevationAssist.Elevation="Dp4">
            <StackPanel Orientation="Horizontal">
                <materialDesign:PackIcon Kind="EmailCheck" 
                                       Width="24" 
                                       Height="24" 
                                       VerticalAlignment="Center"
                                       Margin="0,0,10,0"/>
                <TextBlock Text="Email Verification" 
                          FontSize="20" 
                          FontWeight="Bold"
                          VerticalAlignment="Center"/>
            </StackPanel>
        </materialDesign:ColorZone>

        <!-- Form -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="40,30,40,30" MaxWidth="400">

                <!-- Instructions -->
                <TextBlock Text="Enter the verification code from your email" 
                          FontSize="14"
                          TextWrapping="Wrap"
                          Margin="0,0,0,20"
                          Foreground="{DynamicResource MaterialDesignBodyLight}"/>

                <!-- Token Input -->
                <TextBox materialDesign:HintAssist.Hint="Verification Code"
                        Style="{StaticResource MaterialDesignOutlinedTextBox}"
                        Margin="0,0,0,20"
                        Text="{Binding Token, UpdateSourceTrigger=PropertyChanged}" />

                <!-- Message -->
                <materialDesign:Card Padding="10" 
                                    Margin="0,0,0,15"
                                    Background="{Binding IsSuccess, Converter={StaticResource SuccessBackgroundConverter}}"
                                    Visibility="{Binding Message, Converter={StaticResource StringToVisibilityConverter}}">
                    <TextBlock Text="{Binding Message}"
                              TextWrapping="Wrap"
                              Foreground="{Binding IsSuccess, Converter={StaticResource SuccessForegroundConverter}}"/>
                </materialDesign:Card>

                <!-- Verify Button -->
                <Button Command="{Binding VerifyCommand}"
                       Style="{StaticResource MaterialDesignRaisedButton}"
                       Height="45"
                       Margin="0,10,0,15"
                       Content="VERIFY EMAIL"
                       IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBooleanConverter}}"/>

                <!-- Loading -->
                <ProgressBar IsIndeterminate="True"
                            Height="4"
                            Margin="0,0,0,20"
                            Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                <Separator Margin="0,10,0,20"/>

                <!-- Resend Section -->
                <TextBlock Text="Didn't receive the code?" 
                          FontSize="14"
                          Margin="0,0,0,10"
                          Foreground="{DynamicResource MaterialDesignBodyLight}"/>

                <TextBox materialDesign:HintAssist.Hint="Email Address"
                        Style="{StaticResource MaterialDesignOutlinedTextBox}"
                        Margin="0,0,0,10"
                        Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}" />

                <Button Command="{Binding ResendCommand}"
                       Style="{StaticResource MaterialDesignOutlinedButton}"
                       Height="40"
                       Margin="0,0,0,15"
                       Content="RESEND CODE"
                       IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBooleanConverter}}"/>

                <!-- Close Button -->
                <Button Content="CLOSE"
                       Style="{StaticResource MaterialDesignFlatButton}"
                       HorizontalAlignment="Center"
                       Click="CloseButton_Click"/>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
