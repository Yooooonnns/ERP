<Page x:Class="DigitalisationERP.Desktop.Views.MyTasksPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      Title="Mes Tâches" Height="700" Width="1000">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="Mes Tâches" 
                      FontSize="28" 
                      FontWeight="Bold"
                      Margin="0,0,0,10"/>
            <TextBlock Text="Gérez vos tâches quotidiennes et suivez votre progression" 
                      FontSize="14" 
                      Foreground="Gray"/>
        </StackPanel>

        <!-- Filters & Stats -->
        <Grid Grid.Row="1" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal">
                <ComboBox x:Name="FilterComboBox" 
                         Width="150" 
                         materialDesign:HintAssist.Hint="Filtrer par"
                         Margin="0,0,10,0">
                    <ComboBoxItem Content="Toutes" IsSelected="True"/>
                    <ComboBoxItem Content="En cours"/>
                    <ComboBoxItem Content="Complétées"/>
                    <ComboBoxItem Content="Urgentes"/>
                </ComboBox>

                <ComboBox x:Name="SortComboBox" 
                         Width="150" 
                         materialDesign:HintAssist.Hint="Trier par">
                    <ComboBoxItem Content="Date" IsSelected="True"/>
                    <ComboBoxItem Content="Priorité"/>
                    <ComboBoxItem Content="Statut"/>
                </ComboBox>
            </StackPanel>

            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Border Background="#E3F2FD" CornerRadius="4" Padding="15,8" Margin="0,0,10,0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Total: " FontWeight="SemiBold"/>
                        <TextBlock x:Name="TotalTasksText" Text="12" Foreground="#2196F3" FontWeight="Bold"/>
                    </StackPanel>
                </Border>
                <Border Background="#FFF3E0" CornerRadius="4" Padding="15,8" Margin="0,0,10,0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="En cours: " FontWeight="SemiBold"/>
                        <TextBlock x:Name="ActiveTasksText" Text="7" Foreground="#FF9800" FontWeight="Bold"/>
                    </StackPanel>
                </Border>
                <Border Background="#E8F5E9" CornerRadius="4" Padding="15,8">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Complétées: " FontWeight="SemiBold"/>
                        <TextBlock x:Name="CompletedTasksText" Text="5" Foreground="#4CAF50" FontWeight="Bold"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Grid>

        <!-- Tasks List -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
            <ItemsControl x:Name="TasksItemsControl">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <materialDesign:Card Margin="0,0,0,15" Padding="20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Checkbox -->
                                <CheckBox Grid.Column="0" 
                                         IsChecked="{Binding IsCompleted}"
                                         VerticalAlignment="Top"
                                         Margin="0,5,20,0"/>

                                <!-- Task Details -->
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="{Binding Title}" 
                                             FontSize="16" 
                                             FontWeight="SemiBold"
                                             Margin="0,0,0,8"/>
                                    
                                    <TextBlock Text="{Binding Description}" 
                                             FontSize="13" 
                                             Foreground="Gray"
                                             TextWrapping="Wrap"
                                             Margin="0,0,0,12"/>

                                    <StackPanel Orientation="Horizontal">
                                        <!-- Priority Badge -->
                                        <Border Background="{Binding PriorityColor}" 
                                               CornerRadius="3" 
                                               Padding="10,4"
                                               Margin="0,0,10,0">
                                            <TextBlock Text="{Binding Priority}" 
                                                     FontSize="11" 
                                                     Foreground="White"
                                                     FontWeight="SemiBold"/>
                                        </Border>

                                        <!-- Due Date -->
                                        <StackPanel Orientation="Horizontal" Margin="0,0,15,0">
                                            <materialDesign:PackIcon Kind="CalendarClock" 
                                                                   Width="16" 
                                                                   Height="16"
                                                                   VerticalAlignment="Center"
                                                                   Foreground="Gray"/>
                                            <TextBlock Text="{Binding DueDate}" 
                                                     FontSize="12" 
                                                     Foreground="Gray"
                                                     Margin="5,0,0,0"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <!-- Assigned By -->
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="Account" 
                                                                   Width="16" 
                                                                   Height="16"
                                                                   VerticalAlignment="Center"
                                                                   Foreground="Gray"/>
                                            <TextBlock Text="{Binding AssignedBy}" 
                                                     FontSize="12" 
                                                     Foreground="Gray"
                                                     Margin="5,0,0,0"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Action Buttons -->
                                <StackPanel Grid.Column="2" VerticalAlignment="Center">
                                    <Button Style="{StaticResource MaterialDesignFlatButton}"
                                           Content="Détails"
                                           Height="32"
                                           Margin="0,0,0,5"
                                           Click="TaskDetails_Click"/>
                                    <Button Style="{StaticResource MaterialDesignFlatButton}"
                                           Content="Terminer"
                                           Height="32"
                                           Foreground="#4CAF50"
                                           Click="CompleteTask_Click"/>
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</Page>
