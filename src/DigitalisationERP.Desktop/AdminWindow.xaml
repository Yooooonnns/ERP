<Window x:Class="DigitalisationERP.Desktop.AdminWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Digital ERP - Gestion des Comptes (S-User)" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="#FFFFFF"
        WindowStyle="SingleBorderWindow"
        Loaded="Window_Loaded">
    <Grid>
        <StackPanel Margin="20">
            <!-- Titre -->
            <StackPanel Margin="0,0,0,20">
                <TextBlock Text="Gestion des Comptes Utilisateur" FontSize="32" FontWeight="Bold" Foreground="#1A1A1A"/>
                <TextBlock Text="Validez, modifiez, et gérez les accès des utilisateurs" FontSize="12" Foreground="#666666" Margin="0,8,0,0"/>
                <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                    <Button Content="Ouvrir l'application (Dashboard)" Height="34" Width="240"
                        Background="#1A237E" Foreground="White" FontWeight="SemiBold" Cursor="Hand"
                        Click="OpenMainAppButton_Click"/>
                    <TextBlock Text="(pour voir My Schedule, Task Board, etc.)" FontSize="11" Foreground="#666666" Margin="12,8,0,0"/>
                </StackPanel>
            </StackPanel>

            <!-- Filtres -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                <TextBlock Text="État: " FontSize="12" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <ComboBox x:Name="StatusFilterCombo" Width="150" Height="36" Padding="10,8">
                    <ComboBoxItem Content="En attente" IsSelected="True"/>
                    <ComboBoxItem Content="Approuvé"/>
                    <ComboBoxItem Content="Rejeté"/>
                    <ComboBoxItem Content="Tous"/>
                </ComboBox>

                <TextBlock Text="Rôle: " FontSize="12" VerticalAlignment="Center" Margin="20,0,10,0"/>
                <ComboBox x:Name="RoleFilterCombo" Width="150" Height="36" Padding="10,8">
                    <ComboBoxItem Content="Tous" IsSelected="True"/>
                    <ComboBoxItem Content="Employé"/>
                    <ComboBoxItem Content="Consultant"/>
                    <ComboBoxItem Content="Direction Générale"/>
                    <ComboBoxItem Content="Maintenance IT"/>
                </ComboBox>

                <Button Content="Filtrer" Height="36" Width="80" Margin="20,0,0,0"
                    Background="#0066CC" Foreground="White" FontWeight="SemiBold" Cursor="Hand"
                    Click="FilterButton_Click"/>

                <Button Content="Rafraîchir" Height="36" Width="90" Margin="10,0,0,0"
                    Background="#3498DB" Foreground="White" FontWeight="SemiBold" Cursor="Hand"
                    Click="RefreshButton_Click"/>
            </StackPanel>

            <!-- Tableau des comptes -->
            <DataGrid x:Name="UsersDataGrid" AutoGenerateColumns="False" Height="300" Margin="0,0,0,20" Background="White" BorderBrush="#DDDDDD" BorderThickness="1">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="200"/>
                    <DataGridTextColumn Header="Nom" Binding="{Binding FirstName}" Width="120"/>
                    <DataGridTextColumn Header="Prénom" Binding="{Binding LastName}" Width="120"/>
                    <DataGridTextColumn Header="Département" Binding="{Binding Department}" Width="130"/>
                    <DataGridTextColumn Header="État" Binding="{Binding Status}" Width="100"/>
                    <DataGridTextColumn Header="Date" Binding="{Binding CreatedAt, StringFormat='dd/MM/yyyy'}" Width="100"/>
                    <DataGridTemplateColumn Header="Actions" Width="180">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="0">
                                    <Button Content="✓ Approuver" Background="#27AE60" Foreground="White" Padding="8,4" FontSize="11" Cursor="Hand" Margin="0,0,5,0" Click="ApproveButton_Click"/>
                                    <Button Content="✗ Rejeter" Background="#E74C3C" Foreground="White" Padding="8,4" FontSize="11" Cursor="Hand" Click="RejectButton_Click"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Actions supplémentaires -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                <Button Content="Révoquer l'accès (sélectionné)" Height="36" Width="200"
                    Background="#E74C3C" Foreground="White" FontWeight="SemiBold" Cursor="Hand" Margin="0,0,10,0"
                    Click="RevokeSelected_Click"/>
                <Button Content="Accorder l'accès (sélectionné)" Height="36" Width="200"
                    Background="#27AE60" Foreground="White" FontWeight="SemiBold" Cursor="Hand"
                    Click="GrantSelected_Click"/>
            </StackPanel>

            <!-- Statistiques -->
            <Grid Height="80" Background="#F8FAFC" Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock x:Name="TotalUsersText" Text="0" FontSize="24" FontWeight="Bold" Foreground="#0066CC" TextAlignment="Center"/>
                    <TextBlock Text="Total Utilisateurs" FontSize="11" Foreground="#666666" TextAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock x:Name="PendingUsersText" Text="0" FontSize="24" FontWeight="Bold" Foreground="#F39C12" TextAlignment="Center"/>
                    <TextBlock Text="En attente" FontSize="11" Foreground="#666666" TextAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock x:Name="ApprovedUsersText" Text="0" FontSize="24" FontWeight="Bold" Foreground="#27AE60" TextAlignment="Center"/>
                    <TextBlock Text="Approuvés" FontSize="11" Foreground="#666666" TextAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="3" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock x:Name="RejectedUsersText" Text="0" FontSize="24" FontWeight="Bold" Foreground="#E74C3C" TextAlignment="Center"/>
                    <TextBlock Text="Rejetés" FontSize="11" Foreground="#666666" TextAlignment="Center"/>
                </StackPanel>
            </Grid>

            <!-- Logs -->
            <TextBlock Text="Logs d'Activité" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,10"/>
            <ListBox x:Name="ActivityLogListBox" Height="120" Background="White" BorderBrush="#DDDDDD" BorderThickness="1"/>
        </StackPanel>
    </Grid>
</Window>
